---
title: "On # of days of bad mental health in the past 30 days"
output: 
  html_document:
    toc: true
    toc_float: true
    code_folding: hide
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(ggplot2)
library(survey)
library(srvyr)
library(readr)
library(forcats)
library(gtsummary)

# Set options for allowing a single observation per stratum 
options(survey.lonely.psu = "adjust")
```

```{r include = FALSE}
# Load data
load(file = "./data/brfss_design.Rdata")
```

### Summary statistics

Below is the unweighted counts of the all included demographic variables, exposure, and other covariates, grouped by the self-reported number of days with bad mental health in the past 30 days in the following three categories: none, between 1 and 15 days, and more than 15 days. 

```{r}
tb1_unweighted =
  brfss_design$variables %>%
  tbl_summary(by = mh_bin, percent = "row", 
              include = c(sex, race, age, marital_status,
                             children,
                             education, income, employment,
                             general_health, exercise),
              type = list(exercise ~ "categorical"))

tb1_unweighted
```
We make the following observations about the above summary counts:
* Female are more likely to report longer period with bad mental health.
* Asian are less likely to report longer period with bad mental health, while the proportion for other races are similar.
* It seems that people of older age, married, higher education level, higher income, better general health status and doing more exercise are less likely to be in bad mood for over half a month.
* It seems that the number of children does not influence the length of time people are in bad mood.
* The employed  are less likely to report longer period with bad mental health, while those are unemployed are much more likely to be in bad mood for over half a month.


```{r weighted summary}
tb1_weighted =
  brfss_design %>%
  tbl_svysummary(by = mh_bin, percent = "row", 
                 include = c(sex, race, age, marital_status,
                             children,
                             education, income, employment,
                             general_health, exercise),
                  type = list(exercise ~ "categorical"))

tb1_weighted
```

We can see that the same observations above hold in the weighted summary counts.  

We take closer looks at how gender might interact with the following demographic variables to affect self-reported depression:  


